
## 学习笔记

### 一、知识点

##### 文件类型
文件类型 | 宏 | 说明
--- | --- | ---
普通文件 | ```S_ISREG``` | 包含了某种形式的数据
目录文件 | ```S_ISDIR``` | 包含了其他文件的名字以及指向这些文件有关信息的指针
块特殊文件 | ```S_ISBLK``` | 提供对设备(如磁盘)带缓冲的访问，以固定长度为单位进行访问
字符特殊文件 | ```S_ISCHR``` | 提供对设备(如键盘)不带缓冲的访问
FIFO(命名管道) | ```S_ISFIFO``` | 用于进程间通信
socket(套接字) | ```S_ISSOCK``` | 用于网络上的进程间通信
符号链接 | ```S_ISLNK``` | 指向另一个文件

##### 与一个进程相关联的ID
名称 | 解释
--- | ---
实际用户/组ID | 启动该进程的用户/组ID
有效用户/组ID | 通常等于实际用户/组ID，其决定了文件访问权限
保存的设置用户/组ID | 有效用户/组ID的副本


1. 设置用户ID位：一个文件在```st_mode```中设置了这个标志后，当执行此文件时，将进程的有效用户ID设置为文件所有者的用户ID

2. 如果我们要打开```/usr/include/stdio.h```，那么必须要有对```/usr```和```/usr/include```目录的**执行权限**

3. 进程每次打开、创建或者删除一个文件时，内核就进行文件访问权限测试：
    - 若进程的有效用户ID是0(root)，则允许访问
    - 若进程的有效用户ID等于文件所有者ID，并且适当的访问权限位被设置，则允许访问
    - 按照 用户-->组-->其他用户 的顺序依次执行上一步，直到允许访问或者全部检测完

4. ```access```函数按照实际用户ID和实际组ID进行访问权限测试

5. 文件链接
    - 硬链接
        - 创建：```link old_file new_file```或者```ln old_file new_file```
        - 本质：增加```old_file```的```i```节点的引用计数，```new_file```与```old_file```共享数据块

    - 软链接
        - 创建：```ln -s old_file new_file```
        - 本质：创建新的文件```new_file```，文件内容为```old_file```的路径
        - 查看软链接的文件内容：```readlink -f filename```

6. ```chroot```将指定位置代替```'/'```作为根目录，优点如下：
    - 增加了系统的安全性，限制了用户的权利
    - 建立一个与原系统隔离的系统目录，方便用户开发
    - 切换系统的根目录位置，引导系统启动以及急救系统

### 二、相关API

```
```

### 三、习题

4.1 ```stat()```会返回符号链接指向的文件的信息，```lstat()```会返回符号链接本身这个文件的信息

4.2 创建的文件没有读、写、执行权限

4.4 文件的权限没有改变

4.5 不可以。目录包含```.```和```..```，符号链接包含目标文件的绝对路径

4.6 ？

4.7 ?

4.8 ?

4.9 因为修改了文件的链接计数

4.10 只能递归到一定的层数

4.13 保存原来的值，然后修改其中一个值

4.14 根据登录配置文件的最后访问时间？

4.15 ？

4.16 不同的操作系统有不同的处理策略

4.17 ```/dev```目录关闭了一般用户的写访问权限，以避免用户删除目录中的文件，所以```unlink```失败
